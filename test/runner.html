<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
  "http://www.w3.org/TR/html4/loose.dtd">
<html>
  <head>
    <title>Jasmine Spec Runner</title>
  
    <link rel="shortcut icon" type="image/png" href="/test/lib/jasmine/jasmine_favicon.png">
    <link rel="stylesheet" type="text/css" href="/test/lib/jasmine/jasmine.css">
  
    <!-- jasmine libs libs -->
    <script src="/lib/jquery/jquery.js"></script>
    <script type="text/javascript" src="/test/lib/jasmine/jasmine.js"></script>
    <script type="text/javascript" src="/test/lib/jasmine/jasmine-html.js"></script>
    <script type="text/javascript" src="/test/lib/jasmine/console-runner.js"></script>
  
    <!-- Angular libs -->
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.4/angular.min.js"></script>
  
    <!-- Angular test libraries -->
    <script src="/test/lib/angular/angular-mocks.js"></script>

    <!-- Sinon test libraries -->
    <script src="/test/lib/sinon/sinon.js"></script>

    <!-- Application files -->
    <script src="/directives/bargraph/bargraph.js"></script>
    <script src="/directives/dateshim/dateshimdirective.js"></script>
    <script src="/directives/hidekeyboardonsubmit/hidekeyboardonsubmitdirective.js"></script>
    <script src="/directives/sanitize/fsssanitize.js"></script>
    <script src="/services/datetime/datetimeservice.js"></script>
    <script src="/filters/truncate/truncate.js"></script>
  
    <!-- include spec files here -->
    <script src="/directives/dateshim/test/dateshimdirectiveSpec.js"></script>
    <script src="/services/datetime/test/datetimeserviceSpec.js"></script>
    <script src="/directives/bargraph/test/bargraphSpec.js"></script>
    <script src="/filters/truncate/test/truncateSpec.js"></script>
    <script src="/directives/hidekeyboardonsubmit/test/hidekeyboardonsubmitSpec.js"></script>
    <script src="/directives/sanitize/test/fsssanitizeSpec.js"></script>
  
    <script type="text/javascript">
      (function() {
        var jasmineEnv = jasmine.getEnv();
        jasmineEnv.updateInterval = 1000;
  
        var htmlReporter = new jasmine.HtmlReporter();
        jasmineEnv.addReporter(htmlReporter);

        //Console reporter so phantom js can detect what is happening 
        var consoleReporter = new jasmine.ConsoleReporter();
        jasmineEnv.addReporter(consoleReporter);
        window.console_reporter = consoleReporter;

        jasmineEnv.specFilter = function(spec) {
          return htmlReporter.specFilter(spec);
        };
  
        var currentWindowOnload = window.onload;
  
        window.onload = function() {
          if (currentWindowOnload) {
            currentWindowOnload();
          }
          //Pre-load any templates prior to starting the test run 
          loadTemplates();
        };
        
        /**
        * Loads all templates prior to running tests
        */
        function loadTemplates() {
            var promises = [], templatePromise;
            window.templates = {};
            promises.push(loadTemplate("dateshim", "/directives/dateshim/dateshim.html"));
            //promises.push(loadTemplate("someOtherTemplateHere", "/directives/other/other.html"));
            //Waits for all promises in the array to resolve before running the tests
            $.when.apply($, promises).always(execJasmine);
        }
       
        /**
        * Queues a template to load and stores it as window[name] upon completion
        */
        function loadTemplate(name, path) {
            var templatePromise;
            templatePromise = $.get(path);
            templatePromise.then(function (dateShimTemplate) {
                window.templates[name] = dateShimTemplate;
            }, function () {
                window.templates[name] = "Error loading template";
            });
            return templatePromise;
        }
        
        //Kick off the test run 
        function execJasmine() {
          jasmineEnv.execute();
        }
  
      })();
    </script>
  
  </head>

<body>
</body>
</html>
